{% extends 'base.html' %}
{% block title %}Transit Equity Map{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/scorecard.css') }}">

<script src="https://use.fontawesome.com/a70b68a3fb.js"></script>

<!-- CSS -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/'-awesome/4.7.0/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/map.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/prettydropdown.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/leaflet.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/leaflet-sidebar.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/fa-all.css') }}">

{% endblock%}

{% block content %}
  <div class='container-main'>
      <div id='loading'>LOADING</div>
      <div id="map">
        <script>
            var view = JSON.parse('{{ view | tojson}}');
            var zoom = '{{zoom}}';
            var bgURL = '/static/data/{{region}}_bg.geojson';
        </script>
    </div>

    <div id="sidebar" class="leaflet-sidebar collapsed">
      <!-- Nav tabs -->
      <div class="leaflet-sidebar-tabs">
          <ul role="tablist"> <!-- top aligned tabs -->
              <li><a href="#data" role="tab"><i class="fa fa-cogs" title="Customize the Map"></i></a></li>
              <!-- <li><a href="#charts" role="tab"><i class="fa fa-chart-line" title="Summary charts"></i></a></li> -->
              <li><a href="#share" role="tab"><i class="fa fa-share" title="Share the Map"></i></a></li>
              <li><a href="#download" role="tab"><i class="fa fa-download" title="Download the Data"></i></a></li>
          </ul>
  
          <ul role="tablist"> <!-- bottom aligned tabs -->
              <li><a href="#info" role="tab"><i class="fa fa-info-circle"></i></a></li>
          </ul>
      </div>
  
      <!-- Tab panes -->
      <div class="leaflet-sidebar-content"> 
          <div class="leaflet-sidebar-pane" id="data">
              <h1 class="leaflet-sidebar-header">
                Customize the Map
                <div class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></div>
              </h1>
              <p>Adjust the settings for the map below, then click "Update Map" to explore results. Choose dates from the timeline on the bottom right to see how people have been affected by changes to transit service.</p>

              <p class="label">Opportunity to Access</p>
              <div class="dropdown-select">
                <select class="browser-default" id="destination" name="destination" title="Choose a destination." onchange="optionsUpdate()">
                  <option value="C000" selected>Jobs</option>
                  <option value="CE01" >Low-Wage Jobs</option>
                  <option value="parks" >Parks</option>
                  <option value="snap" >Grocery Stores</option>
                  <option value="hospitals" >Hospitals</option>
                  <option value="urgentcare" >Urgent Care Facilities</option>
                  <option value="pharmacies" >Pharmacies</option>
                  <option value="schools" >Post-Secondary Schools</option>
                  <option value="los" >Transit Service</option>
                </select>
              </div>

              <p id="measurement"></p>

              <p class="label">Time Period</p>
              <div class="dropdown-select">
                <select class="browser-default" id="period" name="period" title="Choose a time period.">
                </select>
              </div>

              <p id="timeDisc">Choose from weekday mornings (7am - 9am), weekday evenings (9pm - 11pm), or weekends (Saturdays, 10am-12pm). For transit service, choose from weekdays or Saturdays</p>

              <p class="label">More Trip Options</p>
              <div class="dropdown-select">
                <select class="browser-default" id="param" name="param" title="Choose a parameter.">
                </select>
              </div>

              <p id="parameterDisc">For measures of access, set the cutoff time for the rider. For travel time to destinations, choose from the travel time to the closest destination (1) or the third-closest destination (3).</p>

              <p class="label">Region</p>
              <div class="dropdown-select">
                <select class="browser-default" id="zones" name="zones" title="Choose a portion of the region to display on the map.">
                  <option value="msa">Metropolitan Statistical Area</option>
                  <option value="er">Economic Region</option>
                  <option value="urban">Urban Core</option>
                  <option value="equity">Equity Neighborhoods</option>
                </select>
              </div>

              <p id="regionDisc">Metropolitan Statistical Areas are the governmental definition of the region; The economic region is the central city and neighboring counties with high volumes of traffic and economic activity; Urban cores are the central city and surrounding high-density areas with racial and economic diversity; equity neighborhoods are underserved by transportation and should be prioritized for quality transit service..</p>

              <p class="label">Low-fare Transit Travel Only</p>
              <div class="dropdown-select">
                <select class="browser-default" id="fare" name="fare" title="Choose a parameter.">
                </select>
              </div>

              <p id="fareDisc">Show access to jobs where one-way fares (including transfers) costs $4 or less (for LA, Chicago, and Philadelphia) or $5 or less (in the Bay area, D.C. Boston, or NYC). </p>

              <p class="label">Show as Transit-Car Ratio</p>
              <div class="dropdown-select">
                <select  class="browser-default" id="auto" name="auto" title="Choose a parameter.">
                </select>
              </div>

              <p id="ratioDisc">When selected as "Yes", show the ratio of transit access (or travel times) to car access (or travel times). A ratio of 1.0 means that an equal number of opportunities can be reached by transit (for access) or that travel time is the same by transit as by car (for travel time measures). A value of 0.1 for access ratios means that one-tenth of the destinations can be reached by transit compared with car for the same cutoff travel time. A travel time ratio of 2.0 means that travel time by transit is twice that of the car.</p>

              <p class="label">Overlay</p>
              <div class="dropdown-select">
                <select class="browser-default" id="demo" name="zones" title="Choose a population overlap to add to the map.">
                  <option value='none'>No Overlay</option>
                  <option value="pop_asiapacific">1 dot = 100 Asian/Pacific Islanders</option>
                  <option value="pop_black">1 dot = 100 Black people</option>
                  <option value="pop_hispanic">1 dot = 100 Latinx people</option>
                  <option value="pop_white">1 dot = 100 White people</option>
                  <option value="pop_poverty">1 dot = 100 people at/below 200% poverty line (low-income)</option>
                  <option value="workers_essential">1 dot = 50 essential workers</option>
                  <option value="hhld_single_mother">1 dot = 50 single-mother households</option>
                  <option value="hhld_nocar">1 dot = 50 no-car households</option>
                </select>
              </div>
              <p id="demoDisc">The overlay shows where different demographics reside in the region. These locations are shown as representative dots.</p>
              <button onclick="updateMapClicked()">Update Map</button>

              <p class='label'>Show  Transit Lines</p>
              <div class="switch">
                <label>
                  Off
                  <input id='transitCheck' checked='checked' type="checkbox" onchange="transitToggle(value)">
                  <span class="lever blue"></span>
                  On
                </label>
              </div>

              <p id="transitDisc">Toggle the location of major transit lines in the region.</p>
          </div>

          <div class="leaflet-sidebar-pane" id="share">
            <h1 class="leaflet-sidebar-header">
                Share the Map
                <div class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></div>
            </h1>
            <p>Copy the link below to share your customized map with its current settings.</p>
            <pre><code id='share-link'></code></pre>
          </div>

          <div class="leaflet-sidebar-pane" id="download">
            <h1 class="leaflet-sidebar-header">
                Download the Data
                <div class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></div>
            </h1>
            <p>Download the data you've selected to display <b>for the entire region</b> either tabulated as a CSV file, or as a spatial dataset (GeoJSON format). This data file does not include any overlays.</p>
            <p><a id='csv-link'>Download CSV</a></p>
            <p><a id='geojson-link'>Download GeoJSON</a></p>
            <p>Visit the <a href='/download'>download center</a> for more datasets.</p>
          </div>

          <div class="leaflet-sidebar-pane" id="info">
            <h1 class="leaflet-sidebar-header">
                About This Application
                <div class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></div>
            </h1>
            <p>This application and the data analysis behind it was proudly built for TransitCenter by
              <a href="http://www.sustainablesystemsresearch.net/">Sustainable Systems Research</a>,
              SF2 Enterprises, and <a href="https://www.klumpentown.com/">Klumpentown Consulting</a>.
            </p>
            
          </div>
      </div>
    </div>
  </div>

<!-- Supporting Scripts -->
<script src="{{ url_for('static', filename='js/d3.v5.js') }}"></script>
<script src="https://unpkg.com/d3-simple-slider"></script>
<script src="{{ url_for('static', filename='js/jquery-3.5.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/leaflet.js') }}"></script>
<script src="{{ url_for('static', filename='js/leaflet-sidebar.js') }}"></script>

<script src="{{ url_for('static', filename='js/moment.js') }}"></script>
<script src="{{ url_for('static', filename='js/leaflet.ajax.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jenks.js') }}"></script>

<!-- Mapping Application Scripts -->
<script src="{{ url_for('static', filename='js/mapstyles.js') }}"></script>
<script src="{{ url_for('static', filename='js/mapevents.js') }}"></script>
<script src="{{ url_for('static', filename='js/maplegend.js') }}"></script>
<script src="{{ url_for('static', filename='js/mapcharts.js') }}"></script>
<script src="{{ url_for('static', filename='js/mapoptions.js') }}"></script>
<script src="{{ url_for('static', filename='js/map.js') }}"></script>

{% endblock %}